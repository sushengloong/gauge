<h1>Transactions</h1>


<div class="chart-panel">
  <ul class="nav nav-tabs">
    <li class="active"><a href="#trend-chart-container-pane" data-toggle="tab">Trend</a></li>
    <li><a href="#breakdown-chart-container-pane" data-toggle="tab">Breakdown</a></li>
  </ul>
  <div class="tab-content">
    <div class="tab-pane fade in active" id="trend-chart-container-pane">
      <div id="trend-chart-container" class="chart-container"></div>
    </div>
    <div class="tab-pane fade" id="breakdown-chart-container-pane">
      <div id="breakdown-chart-container" class="chart-container"</div>
    </div>
  </div>
</div>
<div id="transaction_import_form">
  <%= form_tag import_transactions_path, :multipart => true, id: "import_transactions_form", class: "form-search" do %>
    <%= label_tag :csv_file, "Import CSV:" %>&nbsp;&nbsp;&nbsp;
    <%= file_field_tag :csv_file, accept: "text/csv", class: "input-file" %>
    <%= submit_tag "Upload", class: "btn btn-primary" %>
  <% end %>
</div>
<script type="text/javascript">
  var transactions_chart_data = <%= Transaction.breakdown_chart_data(@transactions) %>;
</script>

<div id="transaction_datatable_form">
  <%= render partial: 'form', locals: {transaction: @transaction} %>
</div>

<div id="transaction_datatable_filter">
  <input id="filter_text_field" type="text" placeholder="search here..." />
</div>

<table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered" id="transactions_datatable">
  <thead>
    <tr>
      <th>Date</th>
      <th>Category</th>
      <th>Note</th>
      <th>Amount</th>
    </tr>
  </thead>
  <tbody>
    <% @transactions.each do |t| %>
      <tr>
        <td><%= t.trans_date.strftime("%d %b %Y") %></td>
        <td><%= t.category.name %></td>
        <td><%= t.note %></td>
        <td><%= display_amount(t) %></td>
      </tr>
    <% end %>
  </tbody>
</table>
